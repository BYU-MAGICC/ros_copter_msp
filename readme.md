This is a ROS node for interfacing a naze32 flight control board for a MAV with an onboard computer running ROS.

The current setup uses an ODROID C1 running ROS on a 300mm size quadcopter with attitude stabilization handled by the Naze32 stabilization board.  This is significantly cheaper and more realistic than using a PixHawk since the onboard computer is more capable of doing path planning, GPS waypoint managmenet, visual odometry, and other higher-level tasks than the PixHawk, plus a naze is an order of magnitude cheaper.

It leverages the Multiwii Serial Protocol (MSP) to receive IMU measurements from the Naze while sending RC signals to the naze based on command inputs from another node.  Currently, it is designed to use "relative_nav::Command" messages, which is a custom message type we designed in the MAGICC lab where I work, but it could very easily be adapted to some other message.  It takes Roll, Pitch, Yawrate and Thrust commands currently, but I plan on adding the capability to control using roll rate and pitch rate with the naze in acro mode.  The naze does particularly well in acro mode, because it doesnt need to do any sort of floating point operations in the trigonometric conversions of accelerometer readings.  This will significantly reduce the loop time of the naze, and lead to tighter response.

Unfortunately, I had to hack the cleanflight firmware to do what I wanted to do.  I'm certain that given some help (which I am seeking) I can make the ROS integration a bit more manageable.  However, until then, there is a hacked version of the June 6, 2015 stable build of cleanflight on my github account, where I have modified some code in src/main/rx/rc.c.  In this file I have put some functionality to enable the safety pilot to take over operation given that the AUX1 channel is flipped off.  We tie this channel to the trainer switch on our transmitter, so it's like the computer is 'buddy boxed.'  RC commands are also taken if the sticks are more than 100 PWM away from center, and the lower of the RC and ROS inputted thrust are taken as the input.  If you have more questions about this, check out lines 444-479 in rx.c mentioned above.
